The Powerpraff girls and boys sat in a string s of length K, they being represented in the string by the characters f and b. As cloning was also discovered until the new episodes appeared, this string was multiplied N times, and the string newly obtained, of length N x K, is placed in order, on lines of D characters. Two boys are friends if they are adjacent horizontally or vertically in the new layout on the lines. Two boys Bx and By are in the same gang if they are friends or if there is a string of boys B1, B2, …, Bm (possibly m can also be 0) such that in the string Bx, B1, B2, …, Bm, By any two boys next to each other are friends. A gang can consist of at least one boy. Knowing the values ​​of K, N, and D, as well as the characters in the string s, find the number of gangs that can be formed, knowing that each boy is part of a single gang.